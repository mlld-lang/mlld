>> Review orchestrator context helpers

>> Flatten a path into a safe filename
exe @flatName(path) = @path.replaceAll("/", "--")

exe @mkdirp(dir) = sh { mkdir -p "$dir" }

>> Flatten array of arrays
exe @flatten(arrays) = js { return arrays.filter(Boolean).flat() }

>> Count findings by severity
exe @countBySeverity(findings, severity) = js {
  return findings.filter(f => f && f.severity === severity).length;
}

>> Tag findings with source phase
exe @tagFindings(findings, phase, source) = js {
  return (findings || []).map((f, i) => ({
    ...f,
    id: f.id || (phase + '-' + source + '-' + i),
    phase: phase,
    source: source
  }));
}

export { @flatName, @mkdirp, @flatten, @countBySeverity, @tagFindings }
