## QA Testing: @topic

You are testing mlld's `@topic` feature through black-box testing.

## Constraints

Use ONLY information available via mlld commands:
- `mlld howto @topic`
- `mlld howto grep <pattern>`
- `mlld howto core-modules`

Do NOT:
- Investigate the mlld codebase (no reading source files)
- Search the Internet
- Read tests/cases/ or other implementation details

Your fresh perspective is valuable - we want to capture genuine first-impression friction.

## First: Check Prior Work

Before creating new experiments, check if `@outputDir/topics/@topic/` already exists:

```bash
ls -la @outputDir/topics/@topic/
```

### If directory exists with experiments:

1. **Review existing results.json files** in each experiment directory
2. **Assess the state:**
   - If L-level experiments are failing with `major` issues: Run through the "Before Declaring Anything Blocked" checklist, then STOP. Document what you tried in a `blocked.md` file and exit.
   - If all experiments pass: Consider adding higher complexity (M->H) or more edge cases
   - If coverage seems complete: Create `complete.md` explaining why no more tests needed, then exit.
3. **Add new experiments** with the next available number (e.g., if 01-03 exist, start at 04)

### If directory doesn't exist:

1. Start with L-level experiments (write files directly -- directories are auto-created)

## Your Task

1. Run `mlld howto @topic` to understand the feature
2. Check for prior work (see above)
3. Create experiments that add value (don't redo existing work)
4. Write `results.json` in each new experiment directory

## Directory Structure

```
@outputDir/topics/@topic/
+-- 01-L-experiment-name/
|   +-- experiment.mld       # REQUIRED: Your test script
|   +-- results.json         # Your findings
|   +-- [other files]        # Support files needed by experiment.mld
+-- 02-M-experiment-name/
|   +-- ...
+-- 03-H-experiment-name/
|   +-- ...
+-- blocked.md               # If L-level fails, explain and stop
+-- complete.md              # If no more tests add value
```

## Creating Directories and Files

**Do NOT use `mkdir` to create experiment directories.** Use the Write tool to create files directly -- it automatically creates parent directories.

**Always save `experiment.mld`** in the experiment directory BEFORE running it. This file:
- Contains the exact mlld code you tested
- Enables debugging failed experiments later
- Can be converted to regression tests

Example workflow:
1. Write your test code to `@outputDir/topics/@topic/04-M-edge-case/experiment.mld` (directory auto-created)
2. Run `mlld @outputDir/topics/@topic/04-M-edge-case/experiment.mld`
3. Record results in `results.json`

<./shared/issue-schemas.md>

## Complexity Levels

- **L** (Low): Single feature, straightforward usage from docs
- **M** (Medium): Feature combinations, realistic workflow
- **H** (High): Edge cases, stress testing, complex integration

## For LLM Testing

If testing LLM-related features, use `@@mlld/claude` with haiku:

```mlld
import { @@haiku } from @@mlld/claude
var @@response = @@haiku("Test prompt")
```

## Success Criteria

Your results.json is valid if:
1. All required fields are present (`experiment`, `topic`, `status`, `summary`, `issues`)
2. `status` is one of: pass, fail, partial
3. `issues` array exists (can be empty for pass)
4. Each issue has valid category and severity enums (severity: major, minor, or enhancement)

**Encouraged fields:**
- `what_works`: Always note positive findings, even in failed experiments
- `workaround`: If you found a way around an issue, document it
- `related_experiments`: Link issues that share root causes across experiments
- `context`: Explain why this experiment exists and what it blocks

<./shared/exploration-checklist.md>

## Exit Conditions

You should EXIT EARLY (without creating new experiments) if:

1. **Stuck**: L-level experiments have `major` issues AND you have exhausted the exploration checklist above. Create `blocked.md` explaining what you tried (including the 3+ approaches) and stop.
2. **Complete**: Sufficient coverage exists (L, M, H with good variety). Create `complete.md` and stop.
3. **Diminishing returns**: Adding more tests won't reveal new information.

When exiting early, briefly explain your reasoning.

## If You Get Blocked by Permissions

If you attempt a tool and it is denied (permission error, not in allowedTools), do NOT retry repeatedly or wait. Instead:

1. **Write a `blocked.json` file** in the topic directory:
   ```json
   {
     "blocked": "Brief description of what you cannot do",
     "attempted_tools": ["Bash(example command)"],
     "partial_work": "Description of what you accomplished before getting blocked"
   }
   ```

2. **Continue with any remaining work you CAN do** (e.g., finish other experiments that don't need the blocked tool).

3. **Exit normally** after writing blocked.json and completing whatever work is possible.

## Begin

1. Check if `@outputDir/topics/@topic/` exists
2. If exists: review prior results, decide whether to add more or exit
3. If not: read the docs first, then create initial experiments
   - Run `mlld howto @topic` to understand the feature
   - Run `mlld howto intro` for fundamentals
   - Run `mlld howto gotchas` for common traps
4. Before running any experiment: `mlld validate <path>` to catch syntax errors
