# Meld Examples

This file contains all test case examples organized by category.
Generated by `tests/utils/ast-fixtures.js`

## Table of Contents

- [Add](#add)
  - [AddTemplateInvocation](#add-addTemplateInvocation)
  - [Path](#add-path)
  - [Section](#add-section)
  - [Template](#add-template)
  - [Url](#add-url)
  - [Variable](#add-variable)
- [Data](#data)
  - [Array](#data-array)
  - [Array directives](#data-array-directives)
  - [Complex](#data-complex)
  - [Exec reference](#data-exec-reference)
  - [Field access](#data-field-access)
  - [Grammar fixes](#data-grammar-fixes)
  - [Mixed types](#data-mixed-types)
  - [Nested directives](#data-nested-directives)
  - [Null values](#data-null-values)
  - [Object](#data-object)
  - [Primitive](#data-primitive)
  - [Template invocation](#data-template-invocation)
  - [Template multiline](#data-template-multiline)
- [Exec](#exec)
  - [Code](#exec-code)
  - [Command](#exec-command)
  - [Reference](#exec-reference)
- [Import](#import)
  - [All](#import-all)
  - [Mixed](#import-mixed)
  - [Selected](#import-selected)
  - [Url](#import-url)
- [Path](#path)
  - [Assignment](#path-assignment)
  - [Url](#path-url)
- [Run](#run)
  - [Code](#run-code)
  - [Command](#run-command)
  - [Command bases](#run-command-bases)
  - [Exec](#run-exec)
- [Text](#text)
  - [Assignment](#text-assignment)
  - [Assignment add](#text-assignment-add)
  - [Assignment path](#text-assignment-path)
  - [Assignment run](#text-assignment-run)
  - [Path](#text-path)
  - [Template](#text-template)
  - [TextTemplateDefinition](#text-textTemplateDefinition)
  - [Url](#text-url)
  - [Url section](#text-url-section)

## Add

### Add AddTemplateInvocation

**Input:**
```meld
@text messageTemplate(user, action) = @add [[{{user}} {{action}} successfully!]]
@add @messageTemplate("Bob", "logged in")
```

**Expected Output:**
```markdown
Bob logged in successfully!
```

### Add Path

#### Section Variant

**Input:**
```meld
@add "Section 1" from [file.md]
```

**Expected Output:**
```markdown
## Section 1
### Subsection 1.1
Content from file
```

**Input:**
```meld
@add [file.md]
```

**Expected Output:**
```markdown
# Title
## Section 1
### Subsection 1.1
Content from file
## Section 2
```

### Add Section

#### Bracket rename Variant

**Input:**
```meld
@add [file.md # Original Title] as "# New Title"
```

**Expected Output:**
```markdown
# New Title
Content under this section
```

#### Bracket Variant

**Input:**
```meld
@add [file.md # Section Title]
```

**Expected Output:**
```markdown
# Section Title
Content under this section
```

#### Rename Variant

**Input:**
```meld
@add "# Original Title" from [file.md] as "# New Title"
```

**Expected Output:**
```markdown
# New Title
Content under this section
```

**Input:**
```meld
@add "# Section Title" from [file.md]
```

**Expected Output:**
```markdown
# Section Title
Content under this section
```

### Add Template

#### Multiline Variant

**Input:**
```meld
@text variable = "value"
@add [[
Content with {{variable}}

And some more content

Hey, here's the same variable again: {{variable}}
]]
```

**Expected Output:**
```markdown
Content with value

And some more content

Hey, here's the same variable again: value
```

#### Variables Variant

**Input:**
```meld
@text variable = "value"
@add [[Content with {{variable}}]]
```

**Expected Output:**
```markdown
Content with value
```

**Input:**
```meld
@add [[This is template content]]
```

**Expected Output:**
```markdown
This is template content
```

### Add Url

**Input:**
```meld
# Add from URL Example

This example demonstrates adding content from a URL.

## Documentation

@add [https://raw.githubusercontent.com/example/repo/main/docs/getting-started.md]

That's all!
```

**Expected Output:**
```markdown
# Add from URL Example

This example demonstrates adding content from a URL.

## Documentation

# Getting Started

Welcome to our project! This guide will help you get up and running quickly.

## Installation

Run `npm install` to get started.

That's all!
```

### Add Variable

**Input:**
```meld
@text variableName = "hello world"
@add @variableName
```

**Expected Output:**
```markdown
hello world
```

## Data

### Data Array

#### Mixed Variant

**Input:**
```meld
@data items = [1, "two", { name: "three" }, [4, 5]]
@add @items[2].name
```

**Expected Output:**
```markdown
three
```

**Input:**
```meld
@data colors = ["red", "green", "blue"]
@add @colors[0]
```

**Expected Output:**
```markdown
red
```

### Data Array directives

**Input:**
```meld
@data testResults = {
  suites: [
    @run [echo "unit: passed"],
    @run [echo "integration: passed"],
    @run [echo "e2e: passed"]
  ],
  count: 3
}
@add [[Test Results:
{{testResults.suites[0]}}
{{testResults.suites[1]}}
{{testResults.suites[2]}}
Total: {{testResults.count}} suites]]
```

**Expected Output:**
```markdown
Test Results:
unit: passed
integration: passed
e2e: passed
Total: 3 suites
```

### Data Complex

**Input:**
```meld
@data results = {
  greeting: @run [echo "Hello from embedded command"],
  value: 42
}
@add @results.greeting
```

**Expected Output:**
```markdown
Hello from embedded command
```

### Data Exec reference

**Input:**
```meld
@exec getDate = @run [echo "2024-01-15"]
@exec getUser = @run [echo "admin"]
@exec getStatus = @run [echo "active"]

@data systemInfo = {
  date: @run @getDate,
  user: @run @getUser,
  status: @run @getStatus,
  nested: {
    backup_date: @run @getDate,
    backup_user: @run @getUser
  }
}

@add [[System Information:
Date: {{systemInfo.date}}
User: {{systemInfo.user}}
Status: {{systemInfo.status}}

Backup Info:
Date: {{systemInfo.nested.backup_date}}
User: {{systemInfo.nested.backup_user}}]]
```

**Expected Output:**
```markdown
System Information:
Date: 2024-01-15
User: admin
Status: active

Backup Info:
Date: 2024-01-15
User: admin
```

### Data Field access

**Input:**
```meld
@data users = [
  {name: "Alice", role: {title: "Admin", level: 5}},
  {name: "Bob", role: {title: "User", level: 1}}
]
@data permissions = {
  adminName: @users[0].name,
  adminLevel: @users[0].role.level,
  userCount: 2
}
@add [[{{permissions.adminName}} has level {{permissions.adminLevel}} access]]
```

**Expected Output:**
```markdown
Alice has level 5 access
```

### Data Grammar fixes

**Input:**
```meld
@text messageTemplate(user, action) = @add [[{{user}} {{action}} successfully!]]
@exec getVersion = @run [echo "v1.2.3"]

@data testAllFixes = {
  message: @add @messageTemplate("Alice", "logged in"),
  version: @run @getVersion,
  nullable: null,
  complex: {
    greeting: @add @messageTemplate("Bob", "signed up"),
    build: @run @getVersion,
    empty: null,
    flag: true
  }
}
```

### Data Mixed types

**Input:**
```meld
@text projectVar = "MyProject"
@data buildInfo = {
  name: @projectVar,
  version: "1.0.0",
  build: 42,
  stable: true,
  status: @run [echo "BUILD_SUCCESS"],
  metadata: {
    tags: ["release", "production"],
    timestamp: @run [echo "2024-01-15"]
  }
}
@add [[
Build {{buildInfo.name}} v{{buildInfo.version}} (#{{buildInfo.build}})
Status: {{buildInfo.status}}
Stable: {{buildInfo.stable}}
Date: {{buildInfo.metadata.timestamp}}
]]
```

**Expected Output:**
```markdown
Build MyProject v1.0.0 (#42)
Status: BUILD_SUCCESS
Stable: true
Date: 2024-01-15
```

### Data Nested directives

**Input:**
```meld
@data config = {
  server: {
    host: "localhost",
    port: 8080,
    version: @run [echo "v1.2.3"],
    env: {
      status: @run [echo "ready"],
      mode: @run [echo "production"]
    }
  },
  debug: true
}
@add [[Server running on {{config.server.host}}:{{config.server.port}}]]
```

**Expected Output:**
```markdown
Server running on localhost:8080
```

### Data Null values

**Input:**
```meld
@data config = {
  name: "TestApp",
  version: "1.0.0",
  description: null,
  settings: {
    debug: false,
    logLevel: null,
    features: {
      auth: true,
      cache: null,
      api: "v2"
    }
  },
  metadata: null
}

@add [[Application Config:
Name: {{config.name}}
Version: {{config.version}}
Description: {{config.description}}
Debug: {{config.settings.debug}}
Log Level: {{config.settings.logLevel}}
Auth: {{config.settings.features.auth}}
Cache: {{config.settings.features.cache}}
API: {{config.settings.features.api}}
Metadata: {{config.metadata}}]]
```

**Expected Output:**
```markdown
Application Config:
Name: TestApp
Version: 1.0.0
Description: null
Debug: false
Log Level: null
Auth: true
Cache: null
API: v2
Metadata: null
```

### Data Object

#### Nested Variant

**Input:**
```meld
@data config = {
  server: {
    port: 8080,
    host: "localhost"
  },
  debug: true
}
@add @config.server.port
```

**Expected Output:**
```markdown
8080
```

**Input:**
```meld
@data user = { "name": "John", "age": 30 }
@add [[
{{user.name}} is {{user.age}}.
]]
```

**Expected Output:**
```markdown
John is 30.
```

### Data Primitive

#### Boolean Variant

**Input:**
```meld
@data isEnabled.value = true
@add @isEnabled.value
```

**Expected Output:**
```markdown
true
```

#### Number Variant

**Input:**
```meld
@data number.count = 42
@add @number.count
```

**Expected Output:**
```markdown
42
```

**Input:**
```meld
@data greeting.text = "Hello, world!"
@add @greeting.text
```

**Expected Output:**
```markdown
Hello, world!
```

### Data Template invocation

**Input:**
```meld
@text greeting(name) = @add [[Hello, {{name}}!]]
@text farewell(name, time) = @add [[Goodbye {{name}}, see you {{time}}!]]

@data messages = {
  welcome: @add @greeting("Alice"),
  goodbye: @add @farewell("Bob", "tomorrow"),
  nested: {
    morning: @add @greeting("Charlie"),
    evening: @add @farewell("David", "next week")
  }
}

@add [[{{messages.welcome}}
{{messages.goodbye}}
{{messages.nested.morning}}
{{messages.nested.evening}}]]
```

**Expected Output:**
```markdown
Hello, Alice!
Goodbye Bob, see you tomorrow!
Hello, Charlie!
Goodbye David, see you next week!
```

### Data Template multiline

**Input:**
```meld
@text projectName = "MeldProject"
@text version = "2.0.0"
@data report = {
  timestamp: @run [echo "2024-01-15T10:30:00Z"],
  status: "Success"
}
@add [[
## Build Summary
Project: {{projectName}}
Version: {{version}}
Status: {{report.status}}
]]
```

**Expected Output:**
```markdown
## Build Summary
Project: MeldProject
Version: 2.0.0
Status: Success
```

## Exec

### Exec Code

#### Multiline Variant

**Input:**
```meld
@text name = "bob smith"
@exec format (name) = @run javascript [
  // Format the name with title case
  const words = name.split(' ');
  const titled = words.map(word => {
    return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
  });
  return titled.join(' ');
]
@run @format("bob smith")
```

**Expected Output:**
```markdown
Bob Smith
```

**Input:**
```meld
@text a = "1"
@text b = "2"
@exec sum (a, b) = @run javascript [console.log(Number(a) + Number(b));]
@run @sum (1, 2)
```

**Expected Output:**
```markdown
3
```

### Exec Command

**Input:**
```meld
@exec greet (name) = @run [echo "Hello, @name!"]
```

### Exec Reference

**Input:**
```meld
@exec echo (text) = @run [echo "@text"]
@exec greet (name) = @run [echo "Hello, @name!"]
@run @greet("World")
```

**Expected Output:**
```markdown
Hello, World!
```

## Import

### Import All

#### Variable Variant

**Input:**
```meld
@path configPath = [config.mld]
@import {*} from [@configPath]
@add @greeting
@add @count
```

**Expected Output:**
```markdown
Hello, world!
42
```

**Input:**
```meld
@import {*} from [config.mld]
@add @greeting
@add @count
```

**Expected Output:**
```markdown
Hello, world!
42
```

### Import Mixed

**Input:**
```meld
# Mixed Path Import Example

This example demonstrates importing from both local files and URLs seamlessly.

## Local Import
@import "./config.mld"

## URL Import  
@import "https://raw.githubusercontent.com/example/repo/main/remote-config.mld"

Now we have variables from both sources!
```

**Expected Output:**
```markdown
# Mixed Path Import Example

This example demonstrates importing from both local files and URLs seamlessly.

## Local Import

## URL Import  

Now we have variables from both sources!
```

### Import Selected

**Input:**
```meld
@import {greeting, count} from [utils.mld]
@add @greeting
@add @count
```

**Expected Output:**
```markdown
Hello, world!
42
```

### Import Url

**Input:**
```meld
# Import from URL Example

This example demonstrates importing from a URL.

@import "https://raw.githubusercontent.com/example/repo/main/config.mld"

The imported variables should now be available.
```

**Expected Output:**
```markdown
# Import from URL Example

This example demonstrates importing from a URL.

The imported variables should now be available.
```

## Path

### Path Assignment

#### Absolute Variant

**Input:**
```meld
@path absPath = [/absolute/path/to/file.ext]
@add [[The absolute path is {{absPath}}]]
```

**Expected Output:**
```markdown
The absolute path is /absolute/path/to/file.ext
```

#### Project Variant

**Input:**
```meld
@path projectSrc = [@./src]
@add [[The project source is {{projectSrc}}]]
```

**Expected Output:**
```markdown
The project source is /Users/adam/dev/meld/src
```

#### Special Variant

**Input:**
```meld
@path homeConfig = [@~/config]
@add [[The config is {{homeConfig}}]]
```

**Expected Output:**
```markdown
The config is /Users/adam/config
```

#### Variable Variant

**Input:**
```meld
@text username = "john"
@path userConfig = [config/@username/settings.json]
@add [[The user config is at {{userConfig}}]]
```

**Expected Output:**
```markdown
The user config is at config/john/settings.json
```

**Input:**
```meld
@path docsDir = [file.md]
@add @docsDir
```

**Expected Output:**
```markdown
Contents of file.md
```

### Path Url

**Input:**
```meld
# Path URL Assignment Example

This example demonstrates assigning a URL to a path variable.

@path apiEndpoint = "https://api.example.com/v1"

You can now use the API endpoint: {{apiEndpoint}}
```

**Expected Output:**
```markdown
# Path URL Assignment Example

This example demonstrates assigning a URL to a path variable.

You can now use the API endpoint: https://api.example.com/v1
```

## Run

### Run Code

#### Multiline Variant

**Input:**
```meld
@run javascript [
function greet() {
  return "Hello from multiline code";
}
console.log(greet());
]
```

**Expected Output:**
```markdown
Hello from multiline code
```

**Input:**
```meld
@run javascript [console.log("Hello from code")]
```

**Expected Output:**
```markdown
Hello from code
```

### Run Command

#### Multiline Variant

**Input:**
```meld
@run [bash -c "echo Line 1 && \
echo Line 2"]
```

**Expected Output:**
```markdown
Line 1
Line 2
```

**Input:**
```meld
@run [echo "Hello from command"]
```

**Expected Output:**
```markdown
Hello from command
```

### Run Command bases

#### Npm run Variant

**Input:**
```meld
# Test npm run script detection

@run [npm run build]

@run [yarn run test]

@run [pnpm run dev]

@run [npm run build:prod]
```

**Expected Output:**
```markdown
# Test npm run script detection

@run [npm run build]

@run [yarn run test]

@run [pnpm run dev]

@run [npm run build:prod]
```

#### Operators Variant

**Input:**
```meld
# Test command operators

@run [ls -la | grep foo | wc -l]

@run [mkdir test && cd test && touch file.txt]

@run [rm -rf temp || echo "Already clean"]

@run [npm test; npm run build; npm run deploy]
```

**Expected Output:**
```markdown
# Test command operators

@run [ls -la | grep foo | wc -l]

@run [mkdir test && cd test && touch file.txt]

@run [rm -rf temp || echo "Already clean"]

@run [npm test; npm run build; npm run deploy]
```

#### Special patterns Variant

**Input:**
```meld
# Test special command patterns

@run [npx prettier --write .]

@run [python -m http.server 8000]

@run [node -e "console.log('Hello')"]

@run [deno run --allow-net server.ts]
```

**Expected Output:**
```markdown
# Test special command patterns

@run [npx prettier --write .]

@run [python -m http.server 8000]

@run [node -e "console.log('Hello')"]

@run [deno run --allow-net server.ts]
```

### Run Exec

#### Parameters Variant

**Input:**
```meld
@exec greetCommand(param) = @run [echo "Hello, @param!"]
@run @greetCommand("World")
```

**Expected Output:**
```markdown
Hello, World!
```

**Input:**
```meld
@exec greetCommand = @run [echo "Hello from predefined command"]
@run @greetCommand
```

**Expected Output:**
```markdown
Hello from predefined command
```

## Text

### Text Assignment

**Input:**
```meld
@text greeting = "Hello, world!"
@add @greeting
```

**Expected Output:**
```markdown
Hello, world!
```

### Text Assignment add

#### Section bracket rename Variant

**Input:**
```meld
@text intro = @add [file.md # Original Title] as "# Renamed Section"
@add @intro
```

**Expected Output:**
```markdown
# Renamed Section
Content under this section
```

#### Section bracket Variant

**Input:**
```meld
@text intro = @add [file.md # Section 1]
@add @intro
```

**Expected Output:**
```markdown
## Section 1
### Subsection 1.1
Content from file
```

**Input:**
```meld
@text content = [file.md]
@add @content
```

**Expected Output:**
```markdown
Content from file
```

### Text Assignment path

**Input:**
```meld
@text content = [file.md]
@add @content
```

**Expected Output:**
```markdown
Content from file
```

### Text Assignment run

**Input:**
```meld
@text result = @run [echo "Command output"]
@add @result
```

**Expected Output:**
```markdown
Command output
```

### Text Path

#### Section bracket rename Variant

**Input:**
```meld
@text sectionContent = [file.md # Original Title] as "# Modified Title"
```

#### Section bracket Variant

**Input:**
```meld
@text sectionContent = [file.md # Section 1]
```

**Input:**
```meld
@text content = file.md
@add @content
```

**Expected Output:**
```markdown
Content from file
```

### Text Template

#### Multiline Variant

**Input:**
```meld
@text variable = "value"
@text multiline = [[
This is a
multi-line template
with {{variable}}
]]
@add @multiline
```

**Expected Output:**
```markdown
This is a
multi-line template
with value
```

**Input:**
```meld
@text variable = "value"
@text template = [[This is a template with {{variable}}]]
@add @template
```

**Expected Output:**
```markdown
This is a template with value
```

### Text TextTemplateDefinition

#### Simple Variant

**Input:**
```meld
@text greeting(name) = @add [[Hello, {{name}}!]]
@add @greeting("World")
```

**Expected Output:**
```markdown
Hello, World!
```

**Input:**
```meld
@text greetingTemplate(name, title) = @add [[
Hello {{title}} {{name}}!
Welcome back, {{name}}!
]]

@text userName = "Alice"
@text userTitle = "Dr."
@add @greetingTemplate(@userName, @userTitle)
```

**Expected Output:**
```markdown
Hello Dr. Alice!
Welcome back, Alice!
```

### Text Url

**Input:**
```meld
# Text from URL Example

This example demonstrates fetching text content from a URL.

@text readme = [https://raw.githubusercontent.com/example/repo/main/README.md]

The content is: {{readme}}
```

**Expected Output:**
```markdown
# Text from URL Example

This example demonstrates fetching text content from a URL.

The content is: # Example Project

This is the README content fetched from the URL.
```

### Text Url section

**Input:**
```meld
# Text from URL Section Example

This example demonstrates fetching a specific section from a URL.

@text installation = "## Installation" from [https://raw.githubusercontent.com/example/repo/main/README.md]

Here's how to install:

{{installation}}
```

**Expected Output:**
```markdown
# Text from URL Section Example

This example demonstrates fetching a specific section from a URL.

Here's how to install:

## Installation

To install the project, run:

```bash
npm install example-project
```
```
