# Mlld Examples

This file contains all test case examples organized by category.
Generated by `tests/utils/ast-fixtures.js`

## Table of Contents

- [Exceptions](#exceptions)
  - [Import non module](#exceptions-import-non-module)
  - [Path module content](#exceptions-path-module-content)
  - [Var text parameterized run command](#exceptions-var-text-parameterized-run-command)
  - [When any with individual actions](#exceptions-when-any-with-individual-actions)
- [Invalid](#invalid)
  - [Comment in array literal](#invalid-comment-in-array-literal)
  - [Comment in object literal](#invalid-comment-in-object-literal)
  - [Comment in when array exe](#invalid-comment-in-when-array-exe)
  - [Comment in when array var](#invalid-comment-in-when-array-var)
  - [Comment in when implicit](#invalid-comment-in-when-implicit)
  - [Exe nested fields](#invalid-exe-nested-fields)
  - [Import wildcard](#invalid-import-wildcard)
  - [Run missing braces](#invalid-run-missing-braces)
  - [Var nested fields](#invalid-var-nested-fields)
- [Valid](#valid)
  - [Examples](#valid-examples)
  - [For basic](#valid-for-basic)
  - [For collection](#valid-for-collection)
  - [For empty array](#valid-for-empty-array)
  - [For object iteration](#valid-for-object-iteration)
  - [For object iteration with keys](#valid-for-object-iteration-with-keys)
- [Warnings](#warnings)
  - [Bare variable reference](#warnings-bare-variable-reference)
  - [Directive in text line](#warnings-directive-in-text-line)
  - [Template syntax in text](#warnings-template-syntax-in-text)

## Exceptions

### Exceptions Import non module

**Input:**
```mlld
# Test Import Non-Module Rejection

/import { content } from "./import-non-module-data.txt"
/show @content
```

### Exceptions Path module content

**Input:**
```mlld
# Test Path Module Rejection

/path @mod = "./path-module-content-module.mld"
/show @mod
```

### Exceptions Var text parameterized run command

**Input:**
```mlld
# Parameterized Text with Run Command (Invalid)

This example shows an invalid syntax where someone tries to create a parameterized text variable with a `@run` command.

/exe @codecat(dir) = run {find @dir -type f -exec sh -c 'echo "<$(realpath --relative-to=@dir {})>"; cat {}; echo "@dir {})>"' \;}

This should fail because:
1. Parameterized text templates should use `@exec` not `@text`
2. The complex shell escaping may not be properly handled
3. There's malformed syntax at the end
```

### Exceptions When any with individual actions

**Input:**
```mlld
/var @condition1 = "true"
/var @condition2 = "false"

# Invalid: any: modifier cannot have individual actions
/when @condition1 any: [
  @condition1 => show "Action 1"
  @condition2 => show "Action 2"
]
```

## Invalid

### Invalid Comment in array literal

**Input:**
```mlld
/var @config = [
  some: "value" >> comment
]
```

### Invalid Comment in object literal

**Input:**
```mlld
/var @config = {
  name: "mlld", << comment
  version: "2.0.0",
  features: ["operators", "expressions", "when"],
  active: true
}
```

### Invalid Comment in when array exe

**Input:**
```mlld
/exe @processData(type, data) = when: [
  @type == "json" => @jsonProcessor(@data) 
  @type == "xml" => @xmlProcessor(@data)
  true => @genericProcessor(@data) << comment
]
```

### Invalid Comment in when array var

**Input:**
```mlld
/var @greeting = when: [
  @time < 12 => "Good morning"
  @time < 18 => "Good afternoon" >> comment
  true => "Good evening"
]
```

### Invalid Comment in when implicit

**Input:**
```mlld
/var @result = when: [
  @x == 1 => "one" << comment  
  @x == 2 => "two"
  true => "other"
]
```

### Invalid Exe nested fields

**Input:**
```mlld
/exe @api.users.list() = {echo "user1, user2, user3"}
```

### Invalid Import wildcard

**Input:**
```mlld
/import { * } from "utils.mld"
```

### Invalid Run missing braces

**Input:**
```mlld
/run echo "Hello World"
```

### Invalid Var nested fields

**Input:**
```mlld
# Test: Nested field declaration in /var

This example attempts to use nested field syntax in a /var directive, which is not allowed:

/var @user.name = "Alice"
```

## Valid

### Valid Examples

**Input:**
```mlld
>> This is a comment and should be ignored
>> I can write a couple lines of them if I want and no one will ever know.

/import { * } from "files/imports.mld"

/var @role = {
    "architect": "You are a senior architect skilled in assessing TypeScript codebases.",
    "ux": "You are a senior ux designer skilled in assessing user experience.",
    "security": "You are a senior security engineer skilled in assessing TypeScript codebases."
}

/var @task = {
    "code_review": "Carefully review the code and test results and advise on the quality of the code and areas of improvement.",
    "ux_review": "Carefully review the user experience and advise on the quality of the user experience and areas of improvement.",
    "security_review": "Carefully review the security of the code and advise on the quality of the security and areas of improvement."
}

## Your role
/show @role.architect

## Documentation
### Architecture
/show @path "./docs/dev/ARCHITECTURE.md" # TESTING INFRASTRUCTURE
### Mlld error handling
/show @path "./docs/dev/ERRORS.md"

## Test Results
/run npm test core/syntax

## Your task
/show @task.code_review

>> this doesn't work but should
>> run @text codecat("./examples")
```

### Valid For basic

**Input:**
```mlld
---
description: Basic for loop output
---

/var @items = ["apple", "banana", "cherry"]
/for @item in @items => /show `Fruit: @item`
```

### Valid For collection

**Input:**
```mlld
---
description: For loop collecting results
---

/var @names = ["Alice", "Bob"]
/exe @greet(name) = `Hello, @name!`
/var @greetings = for @name in @names => @greet(@name)
/show @greetings
```

### Valid For empty array

**Input:**
```mlld
---
description: For loop with empty array
---

/var @empty = []
/for @item in @empty => /show `Item: @item`
/var @results = for @x in @empty => @x
/show @results
```

### Valid For object iteration

**Input:**
```mlld
---
description: For loop iterating over object values
---

/var @config = {"host": "localhost", "port": 3000}
/for @value in @config => /show `Config: @value`
```

### Valid For object iteration with keys

**Input:**
```mlld
---
description: For loop with object key access
---

>> Test that @value_key is available when iterating objects
/var @config = {"host": "localhost", "port": 3000}
/for @value in @config => /show `@value_key: @value`
```

## Warnings

### Warnings Bare variable reference

**Input:**
```mlld
/var @myvar = "Hello world"

This line contains a bare variable reference: @myvar
```

### Warnings Directive in text line

**Input:**
```mlld
/var @myvar = "Hello world"

Some text @add @myvar in the middle of a line.
```

### Warnings Template syntax in text

**Input:**
```mlld
/var @myvar = "Hello world"

This line uses template syntax: {{myvar}}
```
