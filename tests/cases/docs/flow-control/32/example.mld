hook @iter after op:for:iteration = [
  output `iter:@mx.for.index/@mx.for.total key=@mx.for.key batch=@mx.for.batchIndex:@mx.for.batchSize` to "state://loop-events"
]

hook @batchBefore before op:for:batch = [
  output `batch-start:@mx.for.batchIndex size=@mx.for.batchSize` to "state://loop-events"
]

hook @batchAfter after op:for:batch = [
  output `batch-end:@mx.for.batchIndex size=@mx.for.batchSize` to "state://loop-events"
]

var @res = for parallel(2) @x in ["a", "b", "c", "d", "e"] => @x