guard @labelGate before secret = when [
  @input.length < 8 => deny "Secret is too short"
  * => allow
]

guard @runGate before op:run = when [
  @input.any.text.includes("sk-") => deny "Secrets cannot flow to run"
  * => allow
]

exe @safe(value) = when [
  denied => `[blocked] @mx.guard.reason`
  * => @value
]

guard @sanitize before untrusted = when [
  * => allow @input.trim().slice(0, 100)
]