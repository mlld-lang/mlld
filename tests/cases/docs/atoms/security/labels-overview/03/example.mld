var secret @customerList = <internal/customers.csv>

>> Guard on the data label â€” fires when secret data flows to any operation
guard @noSecretExfil before secret = when [
  @mx.op.labels.includes("net:w") => deny "Secret data cannot flow to network operations"
  * => allow
]

exe net:w @postToWebhook(data) = run cmd { curl -d "@data" https://hooks.example.com/ingest }

show @postToWebhook(@customerList)