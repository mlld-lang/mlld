{
  "name": "chain",
  "description": "Test fixture for valid/examples",
  "category": "valid",
  "subcategory": "examples",
  "input": "# Chaining LLM Requests Example\n@import { role } from \"files/imports.mld\"\n\n@text tests = @run [npm test]\n@text res = @run [oneshot --context @tests --task \"What's one thing that's broken here?\"]\n@run [oneshot \"Make a plan to fix this:\\n\\n# Issue:\\n@res\" --system @role.architect]",
  "expected": null,
  "expectedError": null,
  "expectedWarning": null,
  "actualOutput": null,
  "ast": [
    {
      "type": "Text",
      "nodeId": "feecff6f-f9a9-4d7d-98c5-5ca53ed857be",
      "location": {
        "start": {
          "offset": 0,
          "line": 1,
          "column": 1
        },
        "end": {
          "offset": 32,
          "line": 2,
          "column": 1
        }
      },
      "content": "# Chaining LLM Requests Example\n"
    },
    {
      "type": "Directive",
      "nodeId": "4dabe97a-ee58-45fb-918c-ab312f4d23c1",
      "location": {
        "start": {
          "offset": 32,
          "line": 2,
          "column": 1
        },
        "end": {
          "offset": 73,
          "line": 2,
          "column": 42
        }
      },
      "kind": "import",
      "subtype": "importSelected",
      "source": "path",
      "values": {
        "imports": [
          {
            "type": "VariableReference",
            "nodeId": "6a11a966-cd75-4a11-8be6-9bd6afc1a71c",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "import",
            "identifier": "role"
          }
        ],
        "path": [
          {
            "type": "Text",
            "nodeId": "5fe4bca3-110b-40a3-b49e-3bcb5de2d3be",
            "location": {
              "start": {
                "offset": 54,
                "line": 2,
                "column": 23
              },
              "end": {
                "offset": 73,
                "line": 2,
                "column": 42
              }
            },
            "content": "files/imports.mld"
          }
        ]
      },
      "raw": {
        "imports": "role",
        "path": "files/imports.mld"
      },
      "meta": {
        "path": {
          "hasVariables": false,
          "isAbsolute": false,
          "hasExtension": true,
          "extension": "mld",
          "pathSubtype": "filePath"
        }
      }
    },
    {
      "type": "Text",
      "nodeId": "eaf5b9a6-2dc2-40c9-8f8e-d838e8f58d78",
      "location": {
        "start": {
          "offset": 73,
          "line": 2,
          "column": 42
        },
        "end": {
          "offset": 75,
          "line": 4,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Directive",
      "nodeId": "dc651e76-c2bd-492c-af91-2fd52b7a3a23",
      "location": {
        "start": {
          "offset": 75,
          "line": 4,
          "column": 1
        },
        "end": {
          "offset": 104,
          "line": 4,
          "column": 30
        }
      },
      "kind": "text",
      "subtype": "textAssignment",
      "source": "run",
      "values": {
        "identifier": [
          {
            "type": "VariableReference",
            "nodeId": "53c85b99-e01b-4111-aeb9-e9504f6bce9d",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "identifier",
            "identifier": "tests"
          }
        ],
        "content": [
          {
            "type": "Text",
            "nodeId": "1e3c5dc8-4061-4069-98d5-2c92865542d9",
            "location": {
              "start": {
                "offset": 95,
                "line": 4,
                "column": 21
              },
              "end": {
                "offset": 103,
                "line": 4,
                "column": 29
              }
            },
            "content": "npm test"
          }
        ]
      },
      "raw": {
        "identifier": "tests",
        "content": "@run npm test"
      },
      "meta": {
        "sourceType": "directive",
        "directive": "run",
        "hasVariables": false,
        "run": {
          "isCommand": true
        }
      }
    },
    {
      "type": "Newline",
      "nodeId": "50fbf3f1-99da-49e4-9d6b-238f7ff26e7e",
      "location": {
        "start": {
          "offset": 104,
          "line": 4,
          "column": 30
        },
        "end": {
          "offset": 105,
          "line": 5,
          "column": 1
        }
      },
      "content": "\n"
    },
    {
      "type": "Directive",
      "nodeId": "ada79511-0f8a-46ad-83d1-c5e8f95f6114",
      "location": {
        "start": {
          "offset": 105,
          "line": 5,
          "column": 1
        },
        "end": {
          "offset": 194,
          "line": 5,
          "column": 90
        }
      },
      "kind": "text",
      "subtype": "textAssignment",
      "source": "run",
      "values": {
        "identifier": [
          {
            "type": "VariableReference",
            "nodeId": "22481d5f-4284-401a-a61a-a2669a85b10e",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "identifier",
            "identifier": "res"
          }
        ],
        "content": [
          {
            "type": "Text",
            "nodeId": "0b098b00-93e8-45b4-8f9b-f05352c5b1e5",
            "location": {
              "start": {
                "offset": 123,
                "line": 5,
                "column": 19
              },
              "end": {
                "offset": 141,
                "line": 5,
                "column": 37
              }
            },
            "content": "oneshot --context "
          },
          {
            "type": "VariableReference",
            "nodeId": "e21880a4-c804-48df-8f84-72a9a78a5d28",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varIdentifier",
            "identifier": "tests"
          },
          {
            "type": "Text",
            "nodeId": "a8a06cd7-346d-4bb3-b5fc-8dde7b1a573e",
            "location": {
              "start": {
                "offset": 147,
                "line": 5,
                "column": 43
              },
              "end": {
                "offset": 193,
                "line": 5,
                "column": 89
              }
            },
            "content": " --task \"What's one thing that's broken here?\""
          }
        ]
      },
      "raw": {
        "identifier": "res",
        "content": "@run oneshot --context @tests --task \"What's one thing that's broken here?\""
      },
      "meta": {
        "sourceType": "directive",
        "directive": "run",
        "hasVariables": true,
        "run": {
          "isCommand": true
        }
      }
    },
    {
      "type": "Newline",
      "nodeId": "33c02c16-5b94-436e-aed1-02f1ef022072",
      "location": {
        "start": {
          "offset": 194,
          "line": 5,
          "column": 90
        },
        "end": {
          "offset": 195,
          "line": 6,
          "column": 1
        }
      },
      "content": "\n"
    },
    {
      "type": "Directive",
      "nodeId": "ff6a994b-899a-4c9b-9780-3f5c9c437d1f",
      "location": {
        "start": {
          "offset": 195,
          "line": 6,
          "column": 1
        },
        "end": {
          "offset": 279,
          "line": 6,
          "column": 85
        }
      },
      "kind": "run",
      "subtype": "runCommand",
      "source": "command",
      "values": {
        "command": [
          {
            "type": "Text",
            "nodeId": "f6e2b9f0-af75-43ee-a4a2-314e3a05c0ef",
            "location": {
              "start": {
                "offset": 201,
                "line": 6,
                "column": 7
              },
              "end": {
                "offset": 248,
                "line": 6,
                "column": 54
              }
            },
            "content": "oneshot \"Make a plan to fix this:\\n\\n# Issue:\\n"
          },
          {
            "type": "VariableReference",
            "nodeId": "2d02fe6b-bfea-4535-a868-c43d5d01b003",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varIdentifier",
            "identifier": "res"
          },
          {
            "type": "Text",
            "nodeId": "14d4ec58-4053-400c-82e9-1e86d78515ce",
            "location": {
              "start": {
                "offset": 252,
                "line": 6,
                "column": 58
              },
              "end": {
                "offset": 263,
                "line": 6,
                "column": 69
              }
            },
            "content": "\" --system "
          },
          {
            "type": "VariableReference",
            "nodeId": "42c8b859-5297-4f38-8a18-87fb029fa6a1",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varIdentifier",
            "identifier": "role",
            "fields": [
              {
                "type": "field",
                "name": "architect"
              }
            ]
          }
        ],
        "commandBases": [
          {
            "nodeId": "0762c593-8d33-4709-b6d1-a139b060499c",
            "location": {
              "start": {
                "offset": 200,
                "line": 6,
                "column": 6
              },
              "end": {
                "offset": 279,
                "line": 6,
                "column": 85
              }
            },
            "command": "oneshot"
          }
        ]
      },
      "raw": {
        "command": "oneshot \"Make a plan to fix this:\\n\\n# Issue:\\n@res\" --system @role",
        "commandBases": [
          "oneshot"
        ]
      },
      "meta": {
        "hasVariables": true,
        "commandCount": 1,
        "hasScriptRunner": false,
        "isMultiLine": false
      }
    }
  ],
  "parseError": null
}