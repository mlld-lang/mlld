{
  "name": "complex-test-1-nested-imports",
  "description": "Test fixture for valid/examples",
  "category": "valid",
  "subcategory": "examples",
  "input": "# Complex Test 1: Nested Imports and Variable Scoping\n\n@text project_name = \"Meld Complex Test\"\n\n# Create a library file that imports another file\n@text lib_content = [[\n@import { imported_title } from \"files/imports.mld\"\n@text lib_message = \"Library says: {{imported_title}}\"\n@data lib_config = {\n  \"name\": \"lib\",\n  \"version\": \"1.0.0\",\n  \"imported\": @imported_title\n}\n]]\n\n>> Simulate creating the lib file (in real usage, this would be a separate file)\n@exec write_lib(content) = @run [echo '@lib_content @content' > ./files/lib.mld]\n\n@run @write_lib(\"Hi\")\n\n>> Now import from our \"lib\" that itself has imports\n@import { lib_message, lib_config } from \"./files/lib.mld\"\n\n>> Test if nested imports work and variable scoping is correct\n@text final_output = [[\nProject: {{project_name}}\nLibrary Message: {{lib_message}}\nLibrary Config: {{lib_config.name}} v{{lib_config.version}}\nImported Value in Config: {{lib_config.imported}}\n]]\n\n@add @final_output",
  "expected": null,
  "expectedError": null,
  "expectedWarning": null,
  "actualOutput": null,
  "ast": [
    {
      "type": "Text",
      "nodeId": "58d6317d-3686-4187-83ae-ed471cc63186",
      "location": {
        "start": {
          "offset": 0,
          "line": 1,
          "column": 1
        },
        "end": {
          "offset": 55,
          "line": 3,
          "column": 1
        }
      },
      "content": "# Complex Test 1: Nested Imports and Variable Scoping\n\n"
    },
    {
      "type": "Directive",
      "nodeId": "6498293c-fc62-4611-adb7-1b97346af93c",
      "location": {
        "start": {
          "offset": 55,
          "line": 3,
          "column": 1
        },
        "end": {
          "offset": 95,
          "line": 3,
          "column": 41
        }
      },
      "kind": "text",
      "subtype": "textAssignment",
      "source": "literal",
      "values": {
        "identifier": [
          {
            "type": "VariableReference",
            "nodeId": "d7410149-bd56-492c-b04c-287caa3eb0d3",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "identifier",
            "identifier": "project_name"
          }
        ],
        "content": [
          {
            "type": "Text",
            "nodeId": "fe821848-562f-46d7-a8de-95d341549f6a",
            "location": {
              "start": {
                "offset": 76,
                "line": 3,
                "column": 22
              },
              "end": {
                "offset": 95,
                "line": 3,
                "column": 41
              }
            },
            "content": "Meld Complex Test"
          }
        ]
      },
      "raw": {
        "identifier": "project_name",
        "content": "Meld Complex Test"
      },
      "meta": {
        "sourceType": "literal",
        "hasVariables": false,
        "isTemplateContent": false
      }
    },
    {
      "type": "Text",
      "nodeId": "d5e4ea60-f0cf-4f99-ae6e-e2eab345b834",
      "location": {
        "start": {
          "offset": 95,
          "line": 3,
          "column": 41
        },
        "end": {
          "offset": 147,
          "line": 6,
          "column": 1
        }
      },
      "content": "\n\n# Create a library file that imports another file\n"
    },
    {
      "type": "Directive",
      "nodeId": "b6613e50-d7fb-4636-a587-12bab259bceb",
      "location": {
        "start": {
          "offset": 147,
          "line": 6,
          "column": 1
        },
        "end": {
          "offset": 371,
          "line": 14,
          "column": 3
        }
      },
      "kind": "text",
      "subtype": "textTemplate",
      "source": "template",
      "values": {
        "identifier": [
          {
            "type": "VariableReference",
            "nodeId": "4d019e87-b5b0-48b6-885b-2538c35f8015",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "identifier",
            "identifier": "lib_content"
          }
        ],
        "content": [
          {
            "type": "Text",
            "nodeId": "39d58489-1bf3-4fd5-91ea-44d1f92755ea",
            "location": {
              "start": {
                "offset": 169,
                "line": 6,
                "column": 23
              },
              "end": {
                "offset": 257,
                "line": 8,
                "column": 36
              }
            },
            "content": "\n@import { imported_title } from \"files/imports.mld\"\n@text lib_message = \"Library says: "
          },
          {
            "type": "VariableReference",
            "nodeId": "c1918178-2794-4442-a359-538b410a7d68",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "imported_title"
          },
          {
            "type": "Text",
            "nodeId": "87b2c8c5-5039-436f-8f43-ec1d65b86f37",
            "location": {
              "start": {
                "offset": 275,
                "line": 8,
                "column": 54
              },
              "end": {
                "offset": 369,
                "line": 14,
                "column": 1
              }
            },
            "content": "\"\n@data lib_config = {\n  \"name\": \"lib\",\n  \"version\": \"1.0.0\",\n  \"imported\": @imported_title\n}\n"
          }
        ]
      },
      "raw": {
        "identifier": "lib_content",
        "content": "\n@import { imported_title } from \"files/imports.mld\"\n@text lib_message = \"Library says: {{imported_title}}\"\n@data lib_config = {\n  \"name\": \"lib\",\n  \"version\": \"1.0.0\",\n  \"imported\": @imported_title\n}\n"
      },
      "meta": {
        "sourceType": "template",
        "hasVariables": true,
        "isTemplateContent": true
      }
    },
    {
      "type": "Text",
      "nodeId": "c42bf952-81cf-48f5-9d21-d0d0a6b2900d",
      "location": {
        "start": {
          "offset": 371,
          "line": 14,
          "column": 3
        },
        "end": {
          "offset": 373,
          "line": 16,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Comment",
      "nodeId": "8d43fabc-882c-4266-8ef4-a7a4218c4a7d",
      "location": {
        "start": {
          "offset": 373,
          "line": 16,
          "column": 1
        },
        "end": {
          "offset": 454,
          "line": 17,
          "column": 1
        }
      },
      "content": "Simulate creating the lib file (in real usage, this would be a separate file)"
    },
    {
      "type": "Directive",
      "nodeId": "fa6c599b-c1ea-4ae6-aff4-563efa324dc3",
      "location": {
        "start": {
          "offset": 454,
          "line": 17,
          "column": 1
        },
        "end": {
          "offset": 534,
          "line": 17,
          "column": 81
        }
      },
      "kind": "exec",
      "subtype": "execCommand",
      "source": "command",
      "values": {
        "identifier": [
          {
            "type": "Text",
            "nodeId": "97f4bcfc-9d5a-4a5a-bd0d-f81f41dc0a4d",
            "location": {
              "start": {
                "offset": 454,
                "line": 17,
                "column": 1
              },
              "end": {
                "offset": 534,
                "line": 17,
                "column": 81
              }
            },
            "content": "write_lib"
          }
        ],
        "params": [
          "content"
        ],
        "command": [
          {
            "type": "Text",
            "nodeId": "75ca559a-eaf0-4450-b0f1-30a82bcebf1a",
            "location": {
              "start": {
                "offset": 487,
                "line": 17,
                "column": 34
              },
              "end": {
                "offset": 493,
                "line": 17,
                "column": 40
              }
            },
            "content": "echo '"
          },
          {
            "type": "VariableReference",
            "nodeId": "6d7891cf-d8b6-4ea2-a0c7-f744b1f66b39",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varIdentifier",
            "identifier": "lib_content"
          },
          {
            "type": "Text",
            "nodeId": "6772b4ae-4c73-4df3-ae06-8ebe37d44fe4",
            "location": {
              "start": {
                "offset": 505,
                "line": 17,
                "column": 52
              },
              "end": {
                "offset": 506,
                "line": 17,
                "column": 53
              }
            },
            "content": " "
          },
          {
            "type": "VariableReference",
            "nodeId": "dbaab918-2abb-46f8-ab3d-1471730ec227",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varIdentifier",
            "identifier": "content"
          },
          {
            "type": "Text",
            "nodeId": "b4524016-54e2-44cd-b3fa-63786e741fcc",
            "location": {
              "start": {
                "offset": 514,
                "line": 17,
                "column": 61
              },
              "end": {
                "offset": 519,
                "line": 17,
                "column": 66
              }
            },
            "content": "' > ."
          },
          {
            "type": "PathSeparator",
            "nodeId": "f99391da-7dfe-4418-8c21-6a749773f5be",
            "location": {
              "start": {
                "offset": 519,
                "line": 17,
                "column": 66
              },
              "end": {
                "offset": 520,
                "line": 17,
                "column": 67
              }
            },
            "value": "/"
          },
          {
            "type": "Text",
            "nodeId": "5e648582-1ab9-491d-afae-f78d12e065cd",
            "location": {
              "start": {
                "offset": 520,
                "line": 17,
                "column": 67
              },
              "end": {
                "offset": 525,
                "line": 17,
                "column": 72
              }
            },
            "content": "files"
          },
          {
            "type": "PathSeparator",
            "nodeId": "1479ef47-801e-4ad0-811d-f56ecdfa6488",
            "location": {
              "start": {
                "offset": 525,
                "line": 17,
                "column": 72
              },
              "end": {
                "offset": 526,
                "line": 17,
                "column": 73
              }
            },
            "value": "/"
          },
          {
            "type": "Text",
            "nodeId": "c76c800c-9a2e-430c-964b-faa36294dfdb",
            "location": {
              "start": {
                "offset": 526,
                "line": 17,
                "column": 73
              },
              "end": {
                "offset": 533,
                "line": 17,
                "column": 80
              }
            },
            "content": "lib.mld"
          }
        ],
        "commandBases": [
          {
            "nodeId": "ab99f2ee-08e5-46c4-a1e2-8fc32c51d500",
            "location": {
              "start": {
                "offset": 486,
                "line": 17,
                "column": 33
              },
              "end": {
                "offset": 534,
                "line": 17,
                "column": 81
              }
            },
            "command": "echo"
          }
        ]
      },
      "raw": {
        "identifier": "write_lib",
        "params": [
          "content"
        ],
        "command": "echo '@lib_content @content' > ./files/lib.mld",
        "commandBases": [
          "echo"
        ]
      },
      "meta": {
        "hasVariables": true,
        "commandCount": 1,
        "hasScriptRunner": false,
        "parameterCount": 1
      }
    },
    {
      "type": "Text",
      "nodeId": "aa23e7ab-4f8e-4171-8469-cce3d94cec0e",
      "location": {
        "start": {
          "offset": 534,
          "line": 17,
          "column": 81
        },
        "end": {
          "offset": 536,
          "line": 19,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Directive",
      "nodeId": "d5e64f96-21fa-4ef1-9262-24618eafad11",
      "location": {
        "start": {
          "offset": 536,
          "line": 19,
          "column": 1
        },
        "end": {
          "offset": 557,
          "line": 19,
          "column": 22
        }
      },
      "kind": "run",
      "subtype": "runExec",
      "source": "exec",
      "values": {
        "identifier": [
          {
            "type": "Text",
            "nodeId": "64585fac-0055-4394-b784-4c049110b8f3",
            "location": {
              "start": {
                "offset": 542,
                "line": 19,
                "column": 7
              },
              "end": {
                "offset": 557,
                "line": 19,
                "column": 22
              }
            },
            "content": "write_lib"
          }
        ],
        "args": [
          {
            "type": "Text",
            "nodeId": "e4b3aa6f-c53b-40dc-8aea-b26e6f74875d",
            "location": {
              "start": {
                "offset": 552,
                "line": 19,
                "column": 17
              },
              "end": {
                "offset": 556,
                "line": 19,
                "column": 21
              }
            },
            "content": "Hi"
          }
        ]
      },
      "raw": {
        "identifier": "write_lib",
        "args": [
          "Hi"
        ]
      },
      "meta": {
        "argumentCount": 1
      }
    },
    {
      "type": "Text",
      "nodeId": "4e90ef55-3d41-460d-aa46-be4e81d86c56",
      "location": {
        "start": {
          "offset": 557,
          "line": 19,
          "column": 22
        },
        "end": {
          "offset": 559,
          "line": 21,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Comment",
      "nodeId": "c333f3e9-f4de-4b7d-87c4-23e74811562b",
      "location": {
        "start": {
          "offset": 559,
          "line": 21,
          "column": 1
        },
        "end": {
          "offset": 612,
          "line": 22,
          "column": 1
        }
      },
      "content": "Now import from our \"lib\" that itself has imports"
    },
    {
      "type": "Directive",
      "nodeId": "879157f8-e144-4c71-bca8-911221a746db",
      "location": {
        "start": {
          "offset": 612,
          "line": 22,
          "column": 1
        },
        "end": {
          "offset": 670,
          "line": 22,
          "column": 59
        }
      },
      "kind": "import",
      "subtype": "importSelected",
      "source": "path",
      "values": {
        "imports": [
          {
            "type": "VariableReference",
            "nodeId": "6bb1e16b-0368-42e0-999c-7f05eefd6967",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "import",
            "identifier": "lib_message"
          },
          {
            "type": "VariableReference",
            "nodeId": "a3a1db4a-55c1-4402-9705-3a03d0708cb6",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "import",
            "identifier": "lib_config"
          }
        ],
        "path": [
          {
            "type": "Text",
            "nodeId": "966a5f17-4ed4-466f-9ea5-8c0c247eb4de",
            "location": {
              "start": {
                "offset": 653,
                "line": 22,
                "column": 42
              },
              "end": {
                "offset": 670,
                "line": 22,
                "column": 59
              }
            },
            "content": "./files/lib.mld"
          }
        ]
      },
      "raw": {
        "imports": "lib_message, lib_config",
        "path": "./files/lib.mld"
      },
      "meta": {
        "path": {
          "hasVariables": false,
          "isAbsolute": false,
          "hasExtension": true,
          "extension": "mld",
          "pathSubtype": "filePath"
        }
      }
    },
    {
      "type": "Text",
      "nodeId": "75821bc6-96c1-4198-9d4d-2c81ed346aac",
      "location": {
        "start": {
          "offset": 670,
          "line": 22,
          "column": 59
        },
        "end": {
          "offset": 672,
          "line": 24,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Comment",
      "nodeId": "452b0cf8-b667-4799-af02-5bb06c5572b7",
      "location": {
        "start": {
          "offset": 672,
          "line": 24,
          "column": 1
        },
        "end": {
          "offset": 735,
          "line": 25,
          "column": 1
        }
      },
      "content": "Test if nested imports work and variable scoping is correct"
    },
    {
      "type": "Directive",
      "nodeId": "0625ab69-dc2f-4f75-b05d-b97bda6baf21",
      "location": {
        "start": {
          "offset": 735,
          "line": 25,
          "column": 1
        },
        "end": {
          "offset": 930,
          "line": 30,
          "column": 3
        }
      },
      "kind": "text",
      "subtype": "textTemplate",
      "source": "template",
      "values": {
        "identifier": [
          {
            "type": "VariableReference",
            "nodeId": "7a1cc097-127b-4037-abe3-216821a457cc",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "identifier",
            "identifier": "final_output"
          }
        ],
        "content": [
          {
            "type": "Text",
            "nodeId": "3e782d9e-c0e4-4a58-8e07-c7d64c39795c",
            "location": {
              "start": {
                "offset": 758,
                "line": 25,
                "column": 24
              },
              "end": {
                "offset": 768,
                "line": 26,
                "column": 10
              }
            },
            "content": "\nProject: "
          },
          {
            "type": "VariableReference",
            "nodeId": "fc1cea3a-1b5e-4c34-8fb2-6cb64e1c4d78",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "project_name"
          },
          {
            "type": "Text",
            "nodeId": "d8d26f20-1f92-4b62-9807-5c760870bbe3",
            "location": {
              "start": {
                "offset": 784,
                "line": 26,
                "column": 26
              },
              "end": {
                "offset": 802,
                "line": 27,
                "column": 18
              }
            },
            "content": "\nLibrary Message: "
          },
          {
            "type": "VariableReference",
            "nodeId": "f54fdd95-5cea-4cf1-b3b5-0e212f1c7405",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "lib_message"
          },
          {
            "type": "Text",
            "nodeId": "ab455484-29ce-4b26-bdc1-aa36b5de9f7e",
            "location": {
              "start": {
                "offset": 817,
                "line": 27,
                "column": 33
              },
              "end": {
                "offset": 834,
                "line": 28,
                "column": 17
              }
            },
            "content": "\nLibrary Config: "
          },
          {
            "type": "VariableReference",
            "nodeId": "c7f8e5df-fbc7-489e-8100-5243b874967c",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "lib_config",
            "fields": [
              {
                "type": "field",
                "name": "name"
              }
            ]
          },
          {
            "type": "Text",
            "nodeId": "e9f1a08b-499b-4a3c-b532-b0760f13a27d",
            "location": {
              "start": {
                "offset": 853,
                "line": 28,
                "column": 36
              },
              "end": {
                "offset": 855,
                "line": 28,
                "column": 38
              }
            },
            "content": " v"
          },
          {
            "type": "VariableReference",
            "nodeId": "95aaf04e-3a6d-448e-b96e-b73fda27d89b",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "lib_config",
            "fields": [
              {
                "type": "field",
                "name": "version"
              }
            ]
          },
          {
            "type": "Text",
            "nodeId": "4878a13b-4074-4103-a3af-25f3301c325a",
            "location": {
              "start": {
                "offset": 877,
                "line": 28,
                "column": 60
              },
              "end": {
                "offset": 904,
                "line": 29,
                "column": 27
              }
            },
            "content": "\nImported Value in Config: "
          },
          {
            "type": "VariableReference",
            "nodeId": "951dadad-53b2-4eb5-a838-0d65f7250802",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "lib_config",
            "fields": [
              {
                "type": "field",
                "name": "imported"
              }
            ]
          },
          {
            "type": "Text",
            "nodeId": "9cf1d5de-5ba1-4976-b486-cce62e74f808",
            "location": {
              "start": {
                "offset": 927,
                "line": 29,
                "column": 50
              },
              "end": {
                "offset": 928,
                "line": 30,
                "column": 1
              }
            },
            "content": "\n"
          }
        ]
      },
      "raw": {
        "identifier": "final_output",
        "content": "\nProject: {{project_name}}\nLibrary Message: {{lib_message}}\nLibrary Config: {{lib_config}} v{{lib_config}}\nImported Value in Config: {{lib_config}}\n"
      },
      "meta": {
        "sourceType": "template",
        "hasVariables": true,
        "isTemplateContent": true
      }
    },
    {
      "type": "Text",
      "nodeId": "25aeeaa6-9118-4e75-9264-318aeabbb95d",
      "location": {
        "start": {
          "offset": 930,
          "line": 30,
          "column": 3
        },
        "end": {
          "offset": 932,
          "line": 32,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Directive",
      "nodeId": "89b46c71-d8e8-43ee-abb7-9e14fd22f5dd",
      "location": {
        "start": {
          "offset": 932,
          "line": 32,
          "column": 1
        },
        "end": {
          "offset": 950,
          "line": 32,
          "column": 19
        }
      },
      "kind": "add",
      "subtype": "addVariable",
      "source": "variable",
      "values": {
        "variable": [
          {
            "type": "VariableReference",
            "nodeId": "c5a64cef-9af8-4e78-b79b-507d4b974637",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varIdentifier",
            "identifier": "final_output"
          }
        ]
      },
      "raw": {
        "variable": "@final_output"
      },
      "meta": {}
    }
  ],
  "parseError": null
}