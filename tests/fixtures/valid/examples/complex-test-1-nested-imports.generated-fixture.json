{
  "name": "complex-test-1-nested-imports",
  "description": "Test fixture for valid/examples",
  "category": "valid",
  "subcategory": "examples",
  "input": "# Complex Test 1: Nested Imports and Variable Scoping\n\n@text project_name = \"Meld Complex Test\"\n\n# Create a library file that imports another file\n@text lib_content = [[\n@import { imported_title } from \"files/imports.mld\"\n@text lib_message = \"Library says: {{imported_title}}\"\n@data lib_config = {\n  \"name\": \"lib\",\n  \"version\": \"1.0.0\",\n  \"imported\": @imported_title\n}\n]]\n\n>> Simulate creating the lib file (in real usage, this would be a separate file)\n@exec write_lib(content) = @run [echo '@lib_content @content' > ./files/lib.mld]\n\n@run @write_lib(\"Hi\")\n\n>> Now import from our \"lib\" that itself has imports\n@import { lib_message, lib_config } from \"./files/lib.mld\"\n\n>> Test if nested imports work and variable scoping is correct\n@text final_output = [[\nProject: {{project_name}}\nLibrary Message: {{lib_message}}\nLibrary Config: {{lib_config.name}} v{{lib_config.version}}\nImported Value in Config: {{lib_config.imported}}\n]]\n\n@add @final_output",
  "expected": null,
  "expectedError": null,
  "expectedWarning": null,
  "actualOutput": null,
  "ast": [
    {
      "type": "Text",
      "nodeId": "46cd4f49-4b03-48bb-aae5-bd9a0c2d0447",
      "location": {
        "start": {
          "offset": 0,
          "line": 1,
          "column": 1
        },
        "end": {
          "offset": 55,
          "line": 3,
          "column": 1
        }
      },
      "content": "# Complex Test 1: Nested Imports and Variable Scoping\n\n"
    },
    {
      "type": "Directive",
      "nodeId": "df1d69f7-ef36-4c17-a010-71284f943620",
      "location": {
        "start": {
          "offset": 55,
          "line": 3,
          "column": 1
        },
        "end": {
          "offset": 95,
          "line": 3,
          "column": 41
        }
      },
      "kind": "text",
      "subtype": "textAssignment",
      "source": "literal",
      "values": {
        "identifier": [
          {
            "type": "VariableReference",
            "nodeId": "7960f839-6a33-43fc-a2be-4db6c5675962",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "identifier",
            "identifier": "project_name"
          }
        ],
        "content": [
          {
            "type": "Text",
            "nodeId": "138a9b97-3a50-4f45-bf9a-0b85372af240",
            "location": {
              "start": {
                "offset": 76,
                "line": 3,
                "column": 22
              },
              "end": {
                "offset": 95,
                "line": 3,
                "column": 41
              }
            },
            "content": "Meld Complex Test"
          }
        ]
      },
      "raw": {
        "identifier": "project_name",
        "content": "Meld Complex Test"
      },
      "meta": {
        "sourceType": "literal",
        "hasVariables": false,
        "isTemplateContent": false
      }
    },
    {
      "type": "Text",
      "nodeId": "86aee330-d90b-4e68-bf5d-a7eb1b2e00c8",
      "location": {
        "start": {
          "offset": 95,
          "line": 3,
          "column": 41
        },
        "end": {
          "offset": 147,
          "line": 6,
          "column": 1
        }
      },
      "content": "\n\n# Create a library file that imports another file\n"
    },
    {
      "type": "Directive",
      "nodeId": "e5579c94-fb06-4215-a039-5ff3d03cebd1",
      "location": {
        "start": {
          "offset": 147,
          "line": 6,
          "column": 1
        },
        "end": {
          "offset": 371,
          "line": 14,
          "column": 3
        }
      },
      "kind": "text",
      "subtype": "textTemplate",
      "source": "template",
      "values": {
        "identifier": [
          {
            "type": "VariableReference",
            "nodeId": "1241f943-45ea-4079-86fb-37fc0a9750f9",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "identifier",
            "identifier": "lib_content"
          }
        ],
        "content": [
          {
            "type": "Text",
            "nodeId": "47729ec1-2d67-4478-8d82-030038ed8792",
            "location": {
              "start": {
                "offset": 169,
                "line": 6,
                "column": 23
              },
              "end": {
                "offset": 257,
                "line": 8,
                "column": 36
              }
            },
            "content": "\n@import { imported_title } from \"files/imports.mld\"\n@text lib_message = \"Library says: "
          },
          {
            "type": "VariableReference",
            "nodeId": "d61b0623-7578-4d21-9e8d-1b26a36b68d4",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "imported_title"
          },
          {
            "type": "Text",
            "nodeId": "0fc7d4e7-6241-426c-8237-8909ea8a4886",
            "location": {
              "start": {
                "offset": 275,
                "line": 8,
                "column": 54
              },
              "end": {
                "offset": 369,
                "line": 14,
                "column": 1
              }
            },
            "content": "\"\n@data lib_config = {\n  \"name\": \"lib\",\n  \"version\": \"1.0.0\",\n  \"imported\": @imported_title\n}\n"
          }
        ]
      },
      "raw": {
        "identifier": "lib_content",
        "content": "\n@import { imported_title } from \"files/imports.mld\"\n@text lib_message = \"Library says: {{imported_title}}\"\n@data lib_config = {\n  \"name\": \"lib\",\n  \"version\": \"1.0.0\",\n  \"imported\": @imported_title\n}\n"
      },
      "meta": {
        "sourceType": "template",
        "hasVariables": true,
        "isTemplateContent": true
      }
    },
    {
      "type": "Text",
      "nodeId": "8e96f34c-cd12-48c8-aca4-df3e677f33c5",
      "location": {
        "start": {
          "offset": 371,
          "line": 14,
          "column": 3
        },
        "end": {
          "offset": 373,
          "line": 16,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Comment",
      "nodeId": "86544786-8f45-40a2-bc29-624a36783bef",
      "location": {
        "start": {
          "offset": 373,
          "line": 16,
          "column": 1
        },
        "end": {
          "offset": 454,
          "line": 17,
          "column": 1
        }
      },
      "content": "Simulate creating the lib file (in real usage, this would be a separate file)"
    },
    {
      "type": "Directive",
      "nodeId": "b6dc0ebb-ce0b-4b80-8685-8519b35dc470",
      "location": {
        "start": {
          "offset": 454,
          "line": 17,
          "column": 1
        },
        "end": {
          "offset": 534,
          "line": 17,
          "column": 81
        }
      },
      "kind": "exec",
      "subtype": "execCommand",
      "source": "command",
      "values": {
        "identifier": [
          {
            "type": "Text",
            "nodeId": "50b88b05-9e7f-4fe5-ad67-a1d86cd53ace",
            "location": {
              "start": {
                "offset": 454,
                "line": 17,
                "column": 1
              },
              "end": {
                "offset": 534,
                "line": 17,
                "column": 81
              }
            },
            "content": "write_lib"
          }
        ],
        "params": [
          "content"
        ],
        "command": [
          {
            "type": "Text",
            "nodeId": "e4763d5a-d939-4555-8dd2-5b06ee0c7b36",
            "location": {
              "start": {
                "offset": 487,
                "line": 17,
                "column": 34
              },
              "end": {
                "offset": 493,
                "line": 17,
                "column": 40
              }
            },
            "content": "echo '"
          },
          {
            "type": "VariableReference",
            "nodeId": "52460b40-db1d-4498-af98-701e46db62c3",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varIdentifier",
            "identifier": "lib_content"
          },
          {
            "type": "Text",
            "nodeId": "63d164f0-dd97-4995-ae72-379e0b340e6d",
            "location": {
              "start": {
                "offset": 505,
                "line": 17,
                "column": 52
              },
              "end": {
                "offset": 506,
                "line": 17,
                "column": 53
              }
            },
            "content": " "
          },
          {
            "type": "VariableReference",
            "nodeId": "0ab80a9a-b789-456b-a505-dca5d395c24a",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varIdentifier",
            "identifier": "content"
          },
          {
            "type": "Text",
            "nodeId": "75d9a2ef-e116-48bd-85ba-dcc17a8f8558",
            "location": {
              "start": {
                "offset": 514,
                "line": 17,
                "column": 61
              },
              "end": {
                "offset": 519,
                "line": 17,
                "column": 66
              }
            },
            "content": "' > ."
          },
          {
            "type": "PathSeparator",
            "nodeId": "97e22f83-1aaf-442d-82de-b9a112c611e1",
            "location": {
              "start": {
                "offset": 519,
                "line": 17,
                "column": 66
              },
              "end": {
                "offset": 520,
                "line": 17,
                "column": 67
              }
            },
            "value": "/"
          },
          {
            "type": "Text",
            "nodeId": "ea08b057-918f-47f1-9ec4-bc6cf35947b6",
            "location": {
              "start": {
                "offset": 520,
                "line": 17,
                "column": 67
              },
              "end": {
                "offset": 525,
                "line": 17,
                "column": 72
              }
            },
            "content": "files"
          },
          {
            "type": "PathSeparator",
            "nodeId": "5843dfb2-8876-4cba-a025-8408206e3d25",
            "location": {
              "start": {
                "offset": 525,
                "line": 17,
                "column": 72
              },
              "end": {
                "offset": 526,
                "line": 17,
                "column": 73
              }
            },
            "value": "/"
          },
          {
            "type": "Text",
            "nodeId": "31d17663-3f20-4f6b-88a8-a314edb41312",
            "location": {
              "start": {
                "offset": 526,
                "line": 17,
                "column": 73
              },
              "end": {
                "offset": 533,
                "line": 17,
                "column": 80
              }
            },
            "content": "lib.mld"
          }
        ],
        "commandBases": [
          {
            "nodeId": "900942d7-e134-4db8-98d9-28fb53d4195c",
            "location": {
              "start": {
                "offset": 486,
                "line": 17,
                "column": 33
              },
              "end": {
                "offset": 534,
                "line": 17,
                "column": 81
              }
            },
            "command": "echo"
          }
        ]
      },
      "raw": {
        "identifier": "write_lib",
        "params": [
          "content"
        ],
        "command": "echo '@lib_content @content' > ./files/lib.mld",
        "commandBases": [
          "echo"
        ]
      },
      "meta": {
        "hasVariables": true,
        "commandCount": 1,
        "hasScriptRunner": false,
        "parameterCount": 1
      }
    },
    {
      "type": "Text",
      "nodeId": "3c9989ab-8289-4edb-a713-ec6c26276673",
      "location": {
        "start": {
          "offset": 534,
          "line": 17,
          "column": 81
        },
        "end": {
          "offset": 536,
          "line": 19,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Directive",
      "nodeId": "2589bd26-61f2-49af-9af9-39bdffd8bd06",
      "location": {
        "start": {
          "offset": 536,
          "line": 19,
          "column": 1
        },
        "end": {
          "offset": 557,
          "line": 19,
          "column": 22
        }
      },
      "kind": "run",
      "subtype": "runExec",
      "source": "exec",
      "values": {
        "identifier": [
          {
            "type": "Text",
            "nodeId": "b0dd710a-3db8-4d4e-94c5-d98a830d12cd",
            "location": {
              "start": {
                "offset": 542,
                "line": 19,
                "column": 7
              },
              "end": {
                "offset": 557,
                "line": 19,
                "column": 22
              }
            },
            "content": "write_lib"
          }
        ],
        "args": [
          {
            "type": "Text",
            "nodeId": "cc819fec-b32e-4af7-9eb4-5aa0e3dc8dd4",
            "location": {
              "start": {
                "offset": 552,
                "line": 19,
                "column": 17
              },
              "end": {
                "offset": 556,
                "line": 19,
                "column": 21
              }
            },
            "content": "Hi"
          }
        ]
      },
      "raw": {
        "identifier": "write_lib",
        "args": [
          "Hi"
        ]
      },
      "meta": {
        "argumentCount": 1
      }
    },
    {
      "type": "Text",
      "nodeId": "1f43c905-9e4a-44d7-b678-b081deb716f0",
      "location": {
        "start": {
          "offset": 557,
          "line": 19,
          "column": 22
        },
        "end": {
          "offset": 559,
          "line": 21,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Comment",
      "nodeId": "4cbacdf1-8a3b-432e-8edf-9e9c5d0c331d",
      "location": {
        "start": {
          "offset": 559,
          "line": 21,
          "column": 1
        },
        "end": {
          "offset": 612,
          "line": 22,
          "column": 1
        }
      },
      "content": "Now import from our \"lib\" that itself has imports"
    },
    {
      "type": "Directive",
      "nodeId": "3eed6aff-4ec7-4b98-9c45-d1f833188879",
      "location": {
        "start": {
          "offset": 612,
          "line": 22,
          "column": 1
        },
        "end": {
          "offset": 670,
          "line": 22,
          "column": 59
        }
      },
      "kind": "import",
      "subtype": "importSelected",
      "source": "path",
      "values": {
        "imports": [
          {
            "type": "VariableReference",
            "nodeId": "9f831f49-d659-4b6e-89a7-a554f5a257f4",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "import",
            "identifier": "lib_message"
          },
          {
            "type": "VariableReference",
            "nodeId": "8228d6f6-95ef-4c4b-8a79-b30642300e0b",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "import",
            "identifier": "lib_config"
          }
        ],
        "path": [
          {
            "type": "Text",
            "nodeId": "8fc9ee50-433c-43b0-b4d9-4cfdd0708ea3",
            "location": {
              "start": {
                "offset": 653,
                "line": 22,
                "column": 42
              },
              "end": {
                "offset": 670,
                "line": 22,
                "column": 59
              }
            },
            "content": "./files/lib.mld"
          }
        ]
      },
      "raw": {
        "imports": "lib_message, lib_config",
        "path": "./files/lib.mld"
      },
      "meta": {
        "path": {
          "hasVariables": false,
          "isAbsolute": false,
          "hasExtension": true,
          "extension": "mld",
          "pathSubtype": "filePath"
        }
      }
    },
    {
      "type": "Text",
      "nodeId": "00cf7276-d3ce-41a3-8d8f-e16b0bfc820e",
      "location": {
        "start": {
          "offset": 670,
          "line": 22,
          "column": 59
        },
        "end": {
          "offset": 672,
          "line": 24,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Comment",
      "nodeId": "8cf7950d-fc85-4e0d-8f20-bf441d875b32",
      "location": {
        "start": {
          "offset": 672,
          "line": 24,
          "column": 1
        },
        "end": {
          "offset": 735,
          "line": 25,
          "column": 1
        }
      },
      "content": "Test if nested imports work and variable scoping is correct"
    },
    {
      "type": "Directive",
      "nodeId": "4f25a719-26e4-4a5d-b0d0-8d167585386d",
      "location": {
        "start": {
          "offset": 735,
          "line": 25,
          "column": 1
        },
        "end": {
          "offset": 930,
          "line": 30,
          "column": 3
        }
      },
      "kind": "text",
      "subtype": "textTemplate",
      "source": "template",
      "values": {
        "identifier": [
          {
            "type": "VariableReference",
            "nodeId": "63f1efe7-49eb-4bfe-9ff0-ccbf88472a07",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "identifier",
            "identifier": "final_output"
          }
        ],
        "content": [
          {
            "type": "Text",
            "nodeId": "78f23f01-6c63-42cc-8b9b-7d519dc967c6",
            "location": {
              "start": {
                "offset": 758,
                "line": 25,
                "column": 24
              },
              "end": {
                "offset": 768,
                "line": 26,
                "column": 10
              }
            },
            "content": "\nProject: "
          },
          {
            "type": "VariableReference",
            "nodeId": "5acdc07e-e9a3-4f8d-a62e-01b64eee73a5",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "project_name"
          },
          {
            "type": "Text",
            "nodeId": "5f3f961c-f335-4f1e-b3e6-0d2033d80b11",
            "location": {
              "start": {
                "offset": 784,
                "line": 26,
                "column": 26
              },
              "end": {
                "offset": 802,
                "line": 27,
                "column": 18
              }
            },
            "content": "\nLibrary Message: "
          },
          {
            "type": "VariableReference",
            "nodeId": "4349ee0f-e022-472b-a441-e6328e2066a1",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "lib_message"
          },
          {
            "type": "Text",
            "nodeId": "9bf4b2b7-d8b1-441a-827c-f8c0d3122992",
            "location": {
              "start": {
                "offset": 817,
                "line": 27,
                "column": 33
              },
              "end": {
                "offset": 834,
                "line": 28,
                "column": 17
              }
            },
            "content": "\nLibrary Config: "
          },
          {
            "type": "VariableReference",
            "nodeId": "088b2ed4-41c1-463e-9f5e-ed7e4c2d76d6",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "lib_config",
            "fields": [
              {
                "type": "field",
                "name": "name"
              }
            ]
          },
          {
            "type": "Text",
            "nodeId": "6e298940-63bf-411e-ae93-c62902e82926",
            "location": {
              "start": {
                "offset": 853,
                "line": 28,
                "column": 36
              },
              "end": {
                "offset": 855,
                "line": 28,
                "column": 38
              }
            },
            "content": " v"
          },
          {
            "type": "VariableReference",
            "nodeId": "9c2630c0-e860-45aa-9aa4-a1cb6c60c52c",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "lib_config",
            "fields": [
              {
                "type": "field",
                "name": "version"
              }
            ]
          },
          {
            "type": "Text",
            "nodeId": "f7d1d558-6f7a-4a39-a864-a05ffad1af4a",
            "location": {
              "start": {
                "offset": 877,
                "line": 28,
                "column": 60
              },
              "end": {
                "offset": 904,
                "line": 29,
                "column": 27
              }
            },
            "content": "\nImported Value in Config: "
          },
          {
            "type": "VariableReference",
            "nodeId": "b2a1f07a-7154-4923-b2c8-db662b6e490a",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varInterpolation",
            "identifier": "lib_config",
            "fields": [
              {
                "type": "field",
                "name": "imported"
              }
            ]
          },
          {
            "type": "Text",
            "nodeId": "8f99647c-6426-4cf7-b0f0-f03371628e6f",
            "location": {
              "start": {
                "offset": 927,
                "line": 29,
                "column": 50
              },
              "end": {
                "offset": 928,
                "line": 30,
                "column": 1
              }
            },
            "content": "\n"
          }
        ]
      },
      "raw": {
        "identifier": "final_output",
        "content": "\nProject: {{project_name}}\nLibrary Message: {{lib_message}}\nLibrary Config: {{lib_config}} v{{lib_config}}\nImported Value in Config: {{lib_config}}\n"
      },
      "meta": {
        "sourceType": "template",
        "hasVariables": true,
        "isTemplateContent": true
      }
    },
    {
      "type": "Text",
      "nodeId": "26b00366-f169-4a64-8ed3-63c7bfc87e66",
      "location": {
        "start": {
          "offset": 930,
          "line": 30,
          "column": 3
        },
        "end": {
          "offset": 932,
          "line": 32,
          "column": 1
        }
      },
      "content": "\n\n"
    },
    {
      "type": "Directive",
      "nodeId": "fbb8e23a-f350-4a21-bfc1-3b0bc4acd2e5",
      "location": {
        "start": {
          "offset": 932,
          "line": 32,
          "column": 1
        },
        "end": {
          "offset": 950,
          "line": 32,
          "column": 19
        }
      },
      "kind": "add",
      "subtype": "addVariable",
      "source": "variable",
      "values": {
        "variable": [
          {
            "type": "VariableReference",
            "nodeId": "1d91b9ac-1454-412e-a927-d16574cead79",
            "location": {
              "start": {
                "offset": 0,
                "line": 1,
                "column": 1
              },
              "end": {
                "offset": 0,
                "line": 1,
                "column": 1
              }
            },
            "valueType": "varIdentifier",
            "identifier": "final_output"
          }
        ]
      },
      "raw": {
        "variable": "@final_output"
      },
      "meta": {}
    }
  ],
  "parseError": null
}