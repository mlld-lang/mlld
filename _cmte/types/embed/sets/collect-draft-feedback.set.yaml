name: collect-draft-feedback
description: "Collect feedback on the draft type specification for '@{{ directiveName }}' from each relevant service."
# Iterates over the 'services' object defined in workflow.yaml
for_each: services

tasks:
  - useTask: review-specific-directive-draft
    prior_outputs:
      # Map the output from the previous set (draft-spec) 
      # which contains the draft TypeScript definitions.
      draft_spec: "{{ draft-spec.draft-initial-directive-spec.output }}"
      # Use [this] to reference the output corresponding to the current iteration key
      original_request: "{{ gather-requirements.analyze-service-needs-for-directive[this].output }}"
    # Task context will include:
    # - draft_spec (the draft TypeScript code)
    # - original_request
    # - item (the current service object: key, description, docsContent, codeContent)
    # - global_variables (overallArchitecture, directiveName, directiveClarityContent) 