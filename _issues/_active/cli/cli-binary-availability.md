# CLI Binary Availability Issue

## Issue

The Meld CLI binary is not being properly built and made available for use. Despite having the necessary infrastructure in place (package.json configuration and bin/meld.ts entry point), the `meld` command is not functioning after installation.

## Evidence

1. The `bin` field in `package.json` points to a non-existent file:
   ```json
   "bin": {
     "meld": "./dist/cli.cjs"
   }
   ```

2. The build process fails to generate this file:
   ```
   CJS Build failed
   Error: Build failed with 1 error:
   tests/utils/debug/StateDebuggerService/index.ts:7:39: ERROR: Could not resolve "./ContextDebuggerService.js"
   ```

3. When trying to run `npm link` to make the binary available, the binary doesn't function:
   ```
   meld not found
   ```

4. The `dist` directory doesn't contain the expected CLI executable:
   ```
   ls -la dist/
   total 5312
   -rw-r--r--@  1 adam  staff     846 Mar  2 19:51 cli.d.ts
   -rw-r--r--@  1 adam  staff  394312 Mar  2 19:51 index.cjs
   -rw-r--r--@  1 adam  staff  882712 Mar  2 19:51 index.cjs.map
   -rw-r--r--@  1 adam  staff   75558 Mar  2 19:51 index.d.mts
   -rw-r--r--@  1 adam  staff   75558 Mar  2 19:51 index.d.ts
   -rw-r--r--@  1 adam  staff  392228 Mar  2 19:51 index.mjs
   -rw-r--r--@  1 adam  staff  882447 Mar  2 19:51 index.mjs.map
   ```
   
   Note the absence of `cli.cjs` which should be generated by the build process.

## Impact

1. Users cannot use the `meld` command to process Meld files
2. The primary CLI functionality is not available
3. This blocks the basic usage of the tool as a command-line utility

## Root Cause

1. **Build Configuration Issue**: The build process is failing due to the missing `ContextDebuggerService.js` file, preventing the CLI executable from being generated.

2. **tsup Configuration**: The configuration in `tsup.config.ts` may need adjustment to properly handle the CLI entry point and generate the required `cli.cjs` file.

3. **Binary Path Mismatch**: There may be a mismatch between the binary path in `package.json` and what's being generated.

## Potential Solutions

1. **Fix the build dependency issue**: Resolve the missing dependency by creating the necessary file or updating imports to avoid it.

2. **Update tsup configuration**: Verify that the tsup config correctly targets the CLI entry point.

3. **Adjust package.json**: Update the bin path in package.json if necessary to match the actual generated binary.

4. **Create a temporary workaround**: Create a simple wrapper script that directly uses the existing API functions until the full CLI can be properly built.

## Implementation Approach

1. First, resolve the missing `ContextDebuggerService.js` dependency.

2. Review the `tsup.config.ts` file to ensure the CLI entry point is properly configured:
   ```typescript
   // In tsup.config.ts
   export default defineConfig({
     entry: {
       'index': 'api/index.ts',
       'cli': 'cli/index.ts'  // Make sure this entry point is correctly configured
     },
     // ...
   });
   ```

3. After fixing the build, run `npm run build` and verify that `dist/cli.cjs` is generated.

4. Use `npm link` to make the binary available and test the functionality.

This should restore the basic CLI functionality, allowing users to run `meld file.meld` as expected.